@page "/create-support"
@using CosmosDbApp.Models
@using CosmosDbApp.Services
@inject ICosmosDbService CosmosService
@inject NavigationManager Navigation

<h3>Opret Support Henvendelse</h3>

<EditForm Model="@supportMessage" OnValidSubmit="@HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        <label>Navn:</label>
        <InputText @bind-Value="supportMessage.CustomerName" class="form-control" />
        <ValidationMessage For="@(() => supportMessage.CustomerName)" />
    </div>

    <div class="form-group">
        <label>Email:</label>
        <InputText @bind-Value="supportMessage.Email" class="form-control" />
        <ValidationMessage For="@(() => supportMessage.Email)" />
    </div>

    <div class="form-group">
        <label>Telefon:</label>
        <InputText @bind-Value="supportMessage.PhoneNumber" class="form-control" />
        <ValidationMessage For="@(() => supportMessage.PhoneNumber)" />
    </div>

    <div class="form-group">
        <label>Kategori:</label>
        <InputSelect @bind-Value="supportMessage.Category" class="form-control">
            <option value="">Vælg kategori</option>
            <option value="@SupportCategory.TECHNICAL_SETUP">Teknisk opsætning</option>
            <option value="@SupportCategory.DIY_PARTS">Gør-det-selv reservedele</option>
            <option value="@SupportCategory.FEATURE_REQUEST">Forslag til ændringer</option>
            <option value="@SupportCategory.FIND_DEALER">Find forhandler</option>
            <option value="@SupportCategory.REQUEST_CATALOG">Anmod om katalog</option>
            <option value="@SupportCategory.OTHER">Andet</option>
        </InputSelect>
        <ValidationMessage For="@(() => supportMessage.Category)" />
    </div>

    <div class="form-group">
        <label>Beskrivelse:</label>
        <InputTextArea @bind-Value="supportMessage.Description" class="form-control" rows="5" />
        <ValidationMessage For="@(() => supportMessage.Description)" />
    </div>

    <button type="submit" class="btn btn-primary">Opret henvendelse</button>
</EditForm>

@code {
    private SupportMessage supportMessage = new SupportMessage();

    private async Task HandleValidSubmit()
    {
        await CosmosService.AddSupportMessageAsync(supportMessage);
        Navigation.NavigateTo("/support-list");
    }
}